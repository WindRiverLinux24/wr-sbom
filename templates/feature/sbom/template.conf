#
# SPDX-License-Identifier: MIT
# Copyright (C) 2024 Wind River Systems, Inc.
#

SPDX_INCLUDE_SOURCES = "1"

WRTEMPLATE_CLASSES:append = " wrlinux-scancode"

SCANCODE_PRECOESSES_NUMBER ?= "${@oe.utils.cpu_count()}"

# Set BB_NUMBER_THREADS via override SPDX_NUMBER_THREADS
SPDX_NUMBER_THREADS ??= "${@int(oe.utils.cpu_count()/4)}"
BB_NUMBER_THREADS = "${SPDX_NUMBER_THREADS}"

SCANCODE_MAX ?= "${@int(oe.utils.cpu_count()/8+1)}"

OVERRIDES:append = ":bpn-${BPN}"

SCANCODE_JSON_CACHE_DIR ?= "${TOPDIR}/scancode-cache"
SPDX_JSON_CACHE_DIR ?= "${TOPDIR}/scancode-cache"

SCANCODE_SOURCE_SHADOWS:append:bpn-linux-libc-headers = " drivers/gpu/drm/amd/include/asic_reg/dcn/dcn_3_2_0_sh_mask.h"
SCANCODE_SOURCE_SHADOWS:append:bpn-gettext-minimal = " gettext-tools/misc/archive.dir.tar"
SCANCODE_SOURCE_SHADOWS:append:bpn-gettext = " gettext-tools/misc/archive.dir.tar"
SCANCODE_SOURCE_SHADOWS:append:bpn-ovmf = " \
    BaseTools/Source/C/BrotliCompress/brotli/c/common/dictionary.bin \
    BaseTools/Source/C/BrotliCompress/brotli/csharp/org/brotli/dec/Dictionary.cs \
    MdeModulePkg/Library/BrotliCustomDecompressLib/brotli/c/common/dictionary.bin \
    MdeModulePkg/Library/BrotliCustomDecompressLib/brotli/csharp/org/brotli/dec/Dictionary.cs \
"
SCANCODE_SOURCE_SHADOWS:append:bpn-qemu = " \
    roms/edk2/BaseTools/Source/C/BrotliCompress/brotli/c/common/dictionary.bin \
    roms/edk2/BaseTools/Source/C/BrotliCompress/brotli/csharp/org/brotli/dec/Dictionary.cs \
    roms/edk2/MdeModulePkg/Library/BrotliCustomDecompressLib/brotli/c/common/dictionary.bin \
    roms/edk2/MdeModulePkg/Library/BrotliCustomDecompressLib/brotli/csharp/org/brotli/dec/Dictionary.cs \
"
SCANCODE_SOURCE_SHADOWS:append:bpn-brotli = " \
    c/common/dictionary.bin \
    csharp/org/brotli/dec/Dictionary.cs \
"
SCANCODE_SOURCE_SHADOWS:append:bpn-grpc = " \
    third_party/boringssl-with-bazel/crypto_test_data.cc \
"
SCANCODE_PACKAGE_IGNORES:append:bpn-linux-yocto = " \
    usr/lib/modules/*/kernel/drivers/gpu/drm/nouveau/.debug/nouveau.ko \
"
SCANCODE_PACKAGE_SHADOWS:append:bpn-kea = " \
    usr/sbin/.debug/kea-dhcp6 \
    usr/sbin/.debug/kea-lfc \
    usr/sbin/.debug/kea-dhcp4 \
"
SCANCODE_SOURCE_SHADOWS:append:bpn-python3-grpcio = " \
    third_party/boringssl-with-bazel/crypto_test_data.cc \
"
SCANCODE_SOURCE_SHADOWS:append:bpn-gn = " \
    pdf/pdfium/fuzzers/pdfium_xfa_lpm_fuzzer/simple_xfa_pdf.cc \
    pdf/test/data/annots.pdf \
    third_party/angle/third_party/VK-GL-CTS/src/android/cts/main/vk-main-2022-03-01/pipeline/shader-object-linked-binary.txt \
    third_party/angle/third_party/VK-GL-CTS/src/android/cts/main/vk-main-2022-03-01/pipeline/shader-object-unlinked-binary.txt \
    third_party/angle/third_party/VK-GL-CTS/src/external/vulkancts/mustpass/main/vk-default/api.txt \
    third_party/angle/third_party/VK-GL-CTS/src/external/vulkancts/mustpass/main/vk-default/pipeline/shader-object-linked-binary.txt \
    third_party/angle/third_party/VK-GL-CTS/src/external/vulkancts/mustpass/main/vksc-default/api.txt \
    third_party/pdfium/testing/resources/annots_action_handling.pdf \
    third_party/pdfium/testing/resources/bug_1324189.pdf \
    third_party/pdfium/testing/resources/bug_1324503.pdf \
    third_party/pdfium/testing/resources/bug_213.pdf \
    third_party/pdfium/testing/resources/bug_343.pdf \
    third_party/pdfium/testing/resources/bug_355.pdf \
    third_party/pdfium/testing/resources/bug_451265.pdf \
    third_party/pdfium/testing/resources/bug_452455.pdf \
    third_party/pdfium/testing/resources/bug_455199.pdf \
    third_party/pdfium/testing/resources/bug_459580.pdf \
    third_party/pdfium/testing/resources/bug_544880.pdf \
    third_party/pdfium/testing/resources/bug_57.pdf \
    third_party/pdfium/testing/resources/bug_602650.pdf \
    third_party/pdfium/testing/resources/bug_757705.pdf \
    third_party/pdfium/testing/resources/bug_765384.pdf \
    third_party/pdfium/testing/resources/bug_773229.pdf \
    third_party/pdfium/testing/resources/bug_xrefv4_loop.pdf \
    third_party/pdfium/testing/resources/parser_rebuildxref_correct.pdf \
    third_party/pdfium/testing/resources/viewer_pref_types.pdf \
    third_party/pdfium/testing/resources/zero_length_stream.pdf \
    third_party/swiftshader/tests/regres/testlists/vk-master-NOT_SUPPORTED.txt \
    third_party/dawn/third_party/gn/webgpu-cts/test_list.txt \
"
SCANCODE_SOURCE_SHADOWS:append:bpn-chromium-x11 = " \
    pdf/pdfium/fuzzers/pdfium_xfa_lpm_fuzzer/simple_xfa_pdf.cc \
    pdf/test/data/annots.pdf \
    third_party/angle/third_party/VK-GL-CTS/src/android/cts/main/vk-main-2022-03-01/pipeline/shader-object-linked-binary.txt \
    third_party/angle/third_party/VK-GL-CTS/src/android/cts/main/vk-main-2022-03-01/pipeline/shader-object-unlinked-binary.txt \
    third_party/angle/third_party/VK-GL-CTS/src/external/vulkancts/mustpass/main/vk-default/api.txt \
    third_party/angle/third_party/VK-GL-CTS/src/external/vulkancts/mustpass/main/vk-default/pipeline/shader-object-linked-binary.txt \
    third_party/angle/third_party/VK-GL-CTS/src/external/vulkancts/mustpass/main/vksc-default/api.txt \
    third_party/pdfium/testing/resources/annots_action_handling.pdf \
    third_party/pdfium/testing/resources/bug_1324189.pdf \
    third_party/pdfium/testing/resources/bug_1324503.pdf \
    third_party/pdfium/testing/resources/bug_213.pdf \
    third_party/pdfium/testing/resources/bug_343.pdf \
    third_party/pdfium/testing/resources/bug_355.pdf \
    third_party/pdfium/testing/resources/bug_451265.pdf \
    third_party/pdfium/testing/resources/bug_452455.pdf \
    third_party/pdfium/testing/resources/bug_455199.pdf \
    third_party/pdfium/testing/resources/bug_459580.pdf \
    third_party/pdfium/testing/resources/bug_544880.pdf \
    third_party/pdfium/testing/resources/bug_57.pdf \
    third_party/pdfium/testing/resources/bug_602650.pdf \
    third_party/pdfium/testing/resources/bug_757705.pdf \
    third_party/pdfium/testing/resources/bug_765384.pdf \
    third_party/pdfium/testing/resources/bug_773229.pdf \
    third_party/pdfium/testing/resources/bug_xrefv4_loop.pdf \
    third_party/pdfium/testing/resources/parser_rebuildxref_correct.pdf \
    third_party/pdfium/testing/resources/viewer_pref_types.pdf \
    third_party/pdfium/testing/resources/zero_length_stream.pdf \
    third_party/swiftshader/tests/regres/testlists/vk-master-NOT_SUPPORTED.txt \
    third_party/dawn/third_party/gn/webgpu-cts/test_list.txt \
"

SCANCODE_SOURCE_IGNORES:append:bpn-libpcre2 = " testdata/testoutput25"
SCANCODE_MAX_FILE_SIZE:bpn-ovmf = "1024"
SCANCODE_MAX_FILE_SIZE:bpn-qemu = "1024"
SCANCODE_MAX_FILE_SIZE:bpn-brotli = "1024"
SCANCODE_MAX_READ_LINES:bpn-ovmf = "10"
SCANCODE_MAX_READ_LINES:bpn-qemu = "10"
SCANCODE_MAX_READ_LINES:bpn-brotli = "10"

SOURCE_NAME:bpn-gettext-minimal = "gettext"
SOURCE_NAME:bpn-libgcc = "gcc"
SOURCE_NAME:bpn-gcc-source = "gcc"
SOURCE_NAME:bpn-llvm-project-source-18.1.6 = "clang"
SOURCE_NAME:bpn-clang = "clang"
SOURCE_NAME:bpn-compiler-rt = "clang"
SOURCE_NAME:bpn-libcxx = "clang"
SOURCE_NAME:bpn-clang-cross-x86_64 = "clang"
SOURCE_NAME:bpn-clang-crosssdk-x86_64 = "clang"
SOURCE_NAME:bpn-gn = "chromium"
SOURCE_NAME:bpn-chromium-x11 = "chromium"

WRLINUX_SUPPORTED_RECIPE:pn-python3-charset-normalizer = '1'
WRLINUX_SUPPORTED_RECIPE:pn-python3-future = '1'
WRLINUX_SUPPORTED_RECIPE:pn-python3-pefile = '1'
WRLINUX_SUPPORTED_RECIPE:pn-python3-fasteners = '1'
WRLINUX_SUPPORTED_RECIPE:pn-python3-inflection = '1'
